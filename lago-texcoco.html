<!DOCTYPE html>
<html>
<head>
	<title>México</title>
	<meta charset="utf-8" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="css/leaflet.css" />
<style>
	html, body {
		height: 100%;
	}
	
	 #map { position:absolute; top:0; bottom:0; width:100%; }
    .mapbox-maplogo {
      position:absolute;
      display:block;
      height: 20px;
      width: 65px;
      left:10px;
      bottom:10px;
      text-indent: -9999px;
      z-index:99999;
      overflow:hidden;
      background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIIAAAAoCAMAAAAFWtJHAAAAwFBMVEUAAAAAAAAAAABtbW0AAAAAAAAAAAAAAAAAAAAAAAClpaUAAADp6ekAAAD5+fna2toAAAAMDAzv7+/Nzc0AAAA2Njb8/Pz9/f3T09MAAAAAAAD7+/sAAAArKyuxsbH39/fs7OwbGxuIiIjz8/N8fHyenp7u7u74+PgAAAC8vLxWVlbx8fF1dXXl5eVcXFyUlJTQ0NDFxcVCQkLAwMC4uLj19fXo6OjW1tarq6ve3t77+/vi4uL6+vrKysrNzc3///8w7gSSAAAAP3RSTlMAOQNdPSYBPywKexLLGPCxNEHXnzFL+v2nGwf1IEiE6dBFad9jd9PuLo1V2mDDV3Cjl06SiuXIq4C3973ym6BQMVUPAAAEXElEQVR4Ae2WCVP6OBiH05L0l1IqrVbkKHJ54I0oHn+PfP9vtUle0z/YdhbH2XVnd58ZnRJIeHiPJOx//mH4vQSAN+8FjAhFxgHIaPvJeZ99hxwEElon5iAQbj85Y98g8ODwjEOMAvGFyeE3FEKgodTBqj0BJGN9DhyNd5Ta3ean9QEopfaA+LsKhnEKRExqg4FSP6Og7oEkAjBWnxSCgBX4xF+kcLoPcOBQrSv0e5kH7s1j37jECQieCTPiFGxL5VHw2zQWCeeJiPt6kjRQw0XSkIdVChf67xGa4alSnZlT6HEQ8CK9ANbhvXUF9xlDkBfTuHDWScgC9+z5FQpPI12TlwC6+sV7ixR8CUMKiwjm2GQeOQWHMGuHGdbnObJAwCEqFJpNU5H6uaPUaEIKiQfg+PHk1+u4OwW9PlWW2ctbA4BHCtp+cNK+H8Jos4gDmC5ar4Nx9waaG/2B13NgDqS7+vm2RgEtEws82P+kwIHhs/pgkQKcFIhfd7CogtGNjYMHTLpurD0ERbYFw4JaD3GlQuNAL/JEsSAF4HqlCnaHACk4WhOn4OgCkMD5hSpYNYDJTD8Y46n+jsE1kPhVCuR6QBXhFK7MUOu9O6b1SWF3b+/9ZVWMGOlu93E8UDaAhgc7bfH+0DHqKXCkHzoNDFfU+zxiVQrUC9QXTuHYtKpN59OA3IxCG4b7jh6ZFuVockaNTW09mkJzOaPU49a6mE9cAchZpQJNpUWcwgV9r6FJswsFKrITp2B5pMBMdnS0z2HZNy2+BNKxSZxZfglkrFYBJxQnpzA5sN/HheR2aFQoZBLAi149dQoyAYYjW0hHlHguBAdMcR0DuDZ5omevX6+AI8qcU7ikKT3GBHCnXwydgmCC0tRwCnGQ2Wp6Be71yNIWfQSkOl9vAI1SBCNWrwC01RROgX7BuT2HI4r7tFAw086p/NwZEdOEa7R1uAFuNmQPuKAEAjYNQ0CyeoUEWHYBnpQVQgpvc0Ph+gsKlAnKg1+vEHsw5LKciLKCAJobiWBzYFGbCKpHqkZZrxBFHEASyFI59vJPCskcwNVGOWZAOqsrR+pKbaNeAMT1CixMEtlnsqopNxUMzVJT3tY35aXZm6a6Y9QhwMN6BUJWbE1lhbMO1WehkO7poO0sK7em9MJGxp1XSbC1gtugzzSLQmGsX7VntJGSwsPZ2d2z3bIPKzdoOp3Wzqt8G4XyMVUoFIxLx1S7+piaHtCvR3FeRVsq0GFdp9C5TbGpcNqsPqyHKxcfd14h21KhuLKUFU4f3osrC7F6uV3WXFnadL7wyAPeKDXw2RoJCO5GY4DouYvb/gepVXheLoewzPseQG9N/vzilrMIjoStE3++zvle4eSurw7XEe76ynI4aq+v7lEyt1x5awiFlFLQbHKIpabnM3eJLym4Szzzc/du7SU+zOXv9UNpECH7IoH/gecURPlN9vdQpeD47yhIFNX0U0QgvID9nENm+yxk/xb+AGAjNfRZuk9qAAAAAElFTkSuQmCC);
      background-repeat:no-repeat;
      background-position: 0 0 ;
      background-size: 65px 20px;
    }
	
	</style>
</head>
<body>
	<div id="map" style="width: 100%; height: 100%"></div>

	<a href="http://mapbox.com/about/maps" class='mapbox-maplogo' target="_blank">Mapbox</a>
	
	<script src="js/leaflet.js"></script>
	<script src='js/leaflet.markercluster.js'></script>
	<script src="js/leaflet.markercluster.layersupport-src.js"></script>
	<script src="js/leaflet-hash.js"></script>
	<script src="js/leaflet-gps.js"></script>
	<script src="js/jquery-2.1.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-omnivore/0.3.4/leaflet-omnivore.js"></script>	
	
	<!-- Leaflet.markercluster assets -->
    	
	<link rel="stylesheet" href="css/MarkerCluster.css">
    <link rel="stylesheet" href="css/MarkerCluster.Default.css">
	<link rel="stylesheet" href="css/leaflet-gps.css"> 


	<script>
		
		

		var NemachIcons =L.Icon.extend({
			options:{
				shadowUrl:'',
				iconSize:		[50,55],
				iconAnchor:		[45,45],
				popupAnchor:	[-20,-40]
			}
		});

		var tiloIcon = new NemachIcons({iconUrl:'icons/marknemachtilo003.png'}),
			restosIcon = new NemachIcons({iconUrl: 'icons/013.png'}),
			lineaIcon= new NemachIcons({iconUrl:'icons/star-emoji.png'})
			cenotesIcon = new NemachIcons({iconUrl: 'icons/azul.png'});
		L.icon =function (options) {
			return new L.Icon(options);
		};

		var regiones = new L.LayerGroup();
		$.getJSON("data/jsonlago.geojson",function(data){
			L.geoJson(data, {
			style: function(feature) {
				switch (feature.properties.color) {
					case 1: return {color: "#df2828", stroke: null, fillOpacity: .3};
					case 2: return {color: "#df7828", stroke: null, fillOpacity: .3};
					case 3: return {color: "#73ae3b", stroke: null, fillOpacity: .3};
					case 4: return {color: "#027782", stroke: null, fillOpacity: .3};
				}
			},
			onEachFeature: function (feature, layer) {layer.bindPopup(feature.properties.nombre);}
			}).addTo(regiones);
		  });
		  
	    var mbAttr = '' +
				'<a href="http://nemachtilo.mx"> Nemachtilo</a>' +
				'',
			mbUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWljaHRpbG8iLCJhIjoiY2lzcWwxbDRvMDI1dTJ5bTE2ZG40bmt5ZiJ9.KteTH5t327YUQ6onwcuSgw';

	    var grayscale   =  L.tileLayer(mbUrl, {id: 'mapbox.light', attribution: mbAttr}),
			capados	= L.tileLayer('https://api.mapbox.com/styles/v1/michtilo/cj1dteoxn00002ro4nnn00kmm/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWljaHRpbG8iLCJhIjoiY2lzcWwxbDRvMDI1dTJ5bTE2ZG40bmt5ZiJ9.KteTH5t327YUQ6onwcuSgw', {attribution: "<a href='http://nemachtilo.mx/'>Nemachtilo</a>"}),
		    streets  = L.tileLayer(mbUrl, {id: 'mapbox.streets',   attribution: mbAttr});

		var map = L.map('map', {
			center: [23.886,-99.998],
			zoom: 5,
			layers: [capados, sitios]
		});	
		
		var hash = new L.Hash(map);
		
		var baseLayers = {
			
			"Escala de grises": grayscale,
			"Dos": capados,
			"Mapa Nemachtilo": streets			
		};

		var overlays = {
			"Zonas arqueológicas": sitios,
			"Regiones": regiones,
			"Áreas Naturales Protegidas": areasnaturales
		};
		
		var mcg = L.markerClusterGroup.layerSupport({maxClusterRadius: 80}).addTo(map);
		
		mcg.checkIn([
			sitios,
			regiones,
			areasnaturales        
		]);  
		
		sitios.addTo(map);
		
		map.addControl( new L.Control.Gps({marker: new L.Marker([0,0], {icon:lineaIcon, draggable: true}).bindPopup('<strong>Aquí estás tú </strong>')}) );//inizialize control
		
		L.control.layers(baseLayers, overlays).addTo(map);
		
	</script>
</body>
</html>
